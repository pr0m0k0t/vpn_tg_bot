import re
import time

def escape_markdown_v2(text):
    escape_chars = r"_*[]()~`>#+-=|{}.!"
    return re.sub(r'([%s])' % re.escape(escape_chars), r'\\\1', text)


def start_message(username):
    message = (f"üëã –ü—Ä–∏–≤–µ—Ç, {username}\\!\n\n "
               f"–¢–≤–æ—è *–ø—Ä–æ–±–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞* —É–∂–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ ‚úÖ\n"
               f"üéâ _3 –¥–Ω—è –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞_ –∫ –Ω–∞—à–µ–º—É VPN üöÄ\n"
               f"–ü–æ–¥–∫–ª—é—á–∞–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏ –Ω–∞—Å–ª–∞–∂–¥–∞–π—Å—è —Å–≤–æ–±–æ–¥–æ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ üåç")
    return message


def success_message(username, expiry_time):
    strf = escape_markdown_v2(time.strftime('%d.%m.%Y', time.localtime(expiry_time)))
    message = (f"üëã –ü—Ä–∏–≤–µ—Ç, {username}\\!\n\n "
               f"–¢–≤–æ—è *–ø–æ–¥–ø–∏—Å–∫–∞* –∞–∫—Ç–∏–≤–Ω–∞ –¥–æ {strf}‚úÖ\n"
               f"–ü–æ–¥–∫–ª—é—á–∞–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏ –Ω–∞—Å–ª–∞–∂–¥–∞–π—Å—è —Å–≤–æ–±–æ–¥–æ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ üåç")
    return message


def choose_device():
    message = (f" –í—ã–±–µ—Ä–∏ *—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ*, –∫–æ—Ç–æ—Ä–æ–µ —Ö–æ—á–µ—à—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å\\:\n\n"
               f"üì± IPhone\n"
               f"‚òéÔ∏è –°–º–∞—Ä—Ç—Ñ–æ–Ω Android\n"
               f"üñ•Ô∏è –ö–æ–º–ø—å—é—Ç–µ—Ä Windows\n"
               f"üíª –ö–æ–º–ø—å—é—Ç–µ—Ä MacOS\n")
    return message


def help_message():
    supp_link = escape_markdown_v2("@vpn_supp0rtbot")
    message = (f"‚ö†Ô∏è –í–æ–∑–Ω–∏–∫–ª–∏ *–ø—Ä–æ–±–ª–µ–º—ã*\\?\n"  
                f"üì© –ù–∞–ø–∏—à–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É, –∏ –º—ã –ø–æ–º–æ–∂–µ–º —Ä–µ—à–∏—Ç—å –≤—Å—ë –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ üõ†\n\nÔ∏è"
                f"{supp_link}\n\n"
                f"_–ú—ã –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏\\!_")
    return message


def ref_link(ref_link):
    ref = escape_markdown_v2(ref_link)
    message = (f"ü§ù –î–µ–ª–∏—Å—å —Å–≤–æ–±–æ–¥–æ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ —Å –¥—Ä—É–∑—å—è–º–∏\\!\n\n"  
                f"üîó –í–∞—à–∞ *–ø—Ä–∏–≥–ª–∞—Å–∏—Ç–µ–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞*\\: {ref}\n\n"  
                f"üéÅ –ó–∞ –∫–∞–∂–¥–æ–≥–æ –¥—Ä—É–≥–∞ –º—ã –¥–∞—Ä–∏–º —Ç–µ–±–µ _3 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–Ω—è_ –ø–æ–¥–ø–∏—Å–∫–∏ üöÄ\n"  
                f"*–ë–æ–ª—å—à–µ –¥—Ä—É–∑–µ–π ‚Üí –±–æ–ª—å—à–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ –±–µ–∑ –≥—Ä–∞–Ω–∏—Ü\\!*")
    return message

def success_pay(new_expiry):
    strf = escape_markdown_v2(time.strftime('%d.%m.%Y', time.localtime(new_expiry)))
    message = (f"–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–ø–ª–∞—Ç—É\\! –ü–æ–¥–ø–∏—Å–∫–∞ –ø—Ä–æ–¥–ª–µ–Ω–∞ –¥–æ {strf}‚úÖ\n\n"
            f"–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ VPN –Ω–∞ —Å–≤–æ—ë —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º")

    return message
